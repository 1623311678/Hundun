import { Meta } from "@storybook/addon-docs";


<Meta title="Hundun/性能优化/介绍" />

## 性能优化

# 各端性能优化手段与业内方案

## 1. React Native (RN) APP 性能优化

- **减少重渲染**：使用 `PureComponent`、`React.memo`、`shouldComponentUpdate` 避免不必要的渲染。
- **列表优化**：大数据列表用 `FlatList`、`SectionList`，开启 windowing。
- **图片优化**：图片懒加载、压缩、使用合适格式（如 WebP），本地缓存。
- **异步加载**：资源、模块、数据异步加载，减少首屏压力。
- **JS与Native通信优化**：减少 bridge 频繁通信，合并批量操作。
- **动画优化**：使用 `Animated`、`reanimated` 等原生驱动动画。
- **内存管理**：及时释放不再使用的资源，避免内存泄漏。
- **代码分包**：按需加载业务模块，减小包体积。
- **业内方案**：字节跳动、阿里、腾讯等均采用分包、图片CDN、骨架屏、预加载等手段。

## 2. 原生 APP 性能优化

- **UI 渲染优化**：异步布局、合成层优化、减少主线程阻塞。
- **内存优化**：对象池、图片缓存、及时回收无用对象。
- **网络优化**：请求合并、断点续传、CDN加速、HTTP2。
- **启动优化**：懒加载、延迟初始化、冷启动加速、Splash优化。
- **电量优化**：减少后台任务、优化定位与传感器使用。
- **多线程**：合理使用线程池，避免主线程阻塞。
- **业内方案**：美团、微信、支付宝等采用冷启动优化、图片压缩、网络降级、A/B测试等。

## 3. H5 性能优化

- **资源压缩与合并**：JS/CSS/图片压缩，HTTP2多路复用，减少请求数。
- **懒加载与预加载**：图片、路由、模块懒加载，首屏优先。
- **缓存优化**：Service Worker、localStorage、HTTP缓存、CDN。
- **渲染优化**：虚拟列表、骨架屏、减少重排重绘、合成层优化。
- **减少 JS 体积**：Tree Shaking、代码分割、动态 import。
- **异步加载**：异步数据、异步组件。
- **业内方案**：淘宝、京东、携程等采用骨架屏、PWA、SSR、CDN、图片懒加载等。

## 4. 小程序性能优化

- **分包加载**：主包精简，业务分包，按需加载。
- **数据绑定优化**：减少 setData 次数，避免大对象 diff。
- **图片优化**：CDN、WebP、懒加载、压缩。
- **组件复用**：自定义组件、虚拟列表。
- **渲染层与逻辑层通信优化**：合并 setData，减少通信频率。
- **启动优化**：首屏数据预加载、骨架屏、延迟加载非核心模块。
- **业内方案**：微信、支付宝、字节等小程序平台均采用分包、骨架屏、CDN、setData 优化等。

---

**总结：**
- 各端性能优化核心在于减少无效渲染、资源合理分配、异步与懒加载、缓存与分包、网络与图片优化。
- 业内主流方案多采用骨架屏、分包、CDN、图片压缩、首屏优化、异步加载等手段。
- 性能优化需结合具体业务场景持续迭代。